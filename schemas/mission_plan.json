{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "MissionPlan",
    "description": "Complex mission configuration including flight paths and safety parameters.",
    "type": "object",
    "properties": {
        "mission_id": {
            "type": "string",
            "description": "Unique identifier for this plan version."
        },
        "constraints": {
            "type": "object",
            "description": "Safety constraints required to start the mission.",
            "properties": {
                "min_battery_start": {
                    "type": "number",
                    "description": "Minimum battery percentage required (0-100).",
                    "default": 30
                },
                "max_wind_speed": {
                    "type": "number",
                    "description": "Maximum allowed wind speed in m/s.",
                    "default": 10
                },
                "required_sensors": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    },
                    "description": "List of required sensors (e.g. GPS, LIDAR)."
                }
            }
        },
        "waypoints": {
            "type": "array",
            "description": "List of navigation waypoints (MAV_CMD_NAV_WAYPOINT).",
            "items": {
                "type": "object",
                "properties": {
                    "type": {
                        "type": "string",
                        "description": "Waypoint type: TAKEOFF, LAND, RTL, or WAYPOINT (default).",
                        "enum": [
                            "WAYPOINT",
                            "TAKEOFF",
                            "LAND",
                            "RTL"
                        ],
                        "default": "WAYPOINT"
                    },
                    "lat": {
                        "type": "number"
                    },
                    "lon": {
                        "type": "number"
                    },
                    "alt": {
                        "type": "number",
                        "description": "Altitude in meters."
                    },
                    "hold_time": {
                        "type": "number",
                        "description": "Hold time in seconds (optional).",
                        "default": 0
                    },
                    "speed": {
                        "type": "number",
                        "description": "Flight speed to this waypoint in m/s."
                    },
                    "roi": {
                        "type": "object",
                        "description": "Region of Interest (Look at this point).",
                        "properties": {
                            "lat": {
                                "type": "number"
                            },
                            "lon": {
                                "type": "number"
                            },
                            "alt": {
                                "type": "number"
                            }
                        },
                        "required": [
                            "lat",
                            "lon"
                        ]
                    }
                },
                "required": [
                    "lat",
                    "lon",
                    "alt"
                ]
            }
        },
        "fence": {
            "type": "object",
            "description": "Geofence safety boundaries.",
            "properties": {
                "enabled": {
                    "type": "boolean",
                    "default": true
                },
                "max_altitude": {
                    "type": "number"
                },
                "polygon": {
                    "type": "array",
                    "description": "List of points defining the inclusion zone.",
                    "items": {
                        "type": "object",
                        "properties": {
                            "lat": {
                                "type": "number"
                            },
                            "lon": {
                                "type": "number"
                            }
                        },
                        "required": [
                            "lat",
                            "lon"
                        ]
                    }
                }
            }
        },
        "rally_points": {
            "type": "array",
            "description": "Safe return points for RTL failsafes.",
            "items": {
                "type": "object",
                "properties": {
                    "lat": {
                        "type": "number"
                    },
                    "lon": {
                        "type": "number"
                    },
                    "alt": {
                        "type": "number",
                        "description": "Loiter altitude."
                    }
                },
                "required": [
                    "lat",
                    "lon",
                    "alt"
                ]
            }
        }
    }
}